var __awaiter=this&&this.__awaiter||function(n,t,i,r){function u(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i||(i=Promise))(function(i,f){function o(n){try{e(r.next(n))}catch(t){f(t)}}function s(n){try{e(r["throw"](n))}catch(t){f(t)}}function e(n){n.done?i(n.value):u(n.value).then(o,s)}e((r=r.apply(n,t||[])).next())})},XRM,KAS;(function(n){var t;(function(t){class i{static valueOrDefault(n,t=null){return n?n:t}static nullableNumberToString(n){return n?n.toString():""}static nullableStringToString(n){return n?n:""}static nullableStringToNumber(n){return n?parseInt(n):null}static jsonDateToDateString(n){if(!n)return"";try{n=n.replace(/\D/g,"");let t=new Date(parseInt(n));return t.toLocaleDateString()}catch(t){return""}}static ensureResponse(n,t){n&&t&&(n.responseText&&t(JSON.parse(n.responseText)),n.json().then(n=>{t(n)}))}static ensureResponseAsync(n){return __awaiter(this,void 0,void 0,function*(){return n?n.responseText?JSON.parse(n.responseText):n.json():null})}static callGenericActionAsync(n,t){return __awaiter(this,void 0,void 0,function*(){let r={Type:n,Request:t,getMetadata:function(){return{boundParameter:null,parameterTypes:{Type:{typeName:"Edm.String",structuralProperty:1},Request:{typeName:"Edm.String",structuralProperty:1}},operationType:0,operationName:"dss_GenericAction"}}},i=yield Xrm.WebApi.online.execute(r);if(i.ok){let n=yield this.ensureResponseAsync(i);return n.Response}return null})}static callGenericAction(t,i,r){let u={Type:t,Request:i,getMetadata:function(){return{boundParameter:null,parameterTypes:{Type:{typeName:"Edm.String",structuralProperty:1},Request:{typeName:"Edm.String",structuralProperty:1}},operationType:0,operationName:"dss_GenericAction"}}};Xrm.WebApi.online.execute(u).then(t=>{t.ok&&n.Libs.QueryHelper.ensureResponse(t,n=>{r(n.Response)})},n=>{Xrm.Utility.alertDialog(n.message,null)})}}t.QueryHelper=i})(t=n.Libs||(n.Libs={}))})(XRM||(XRM={})),function(n){var t;(function(n){class t{constructor(n){this.formContext=n}attributeIsDirty(n){let t=this.formContext.getAttribute(n);return t&&t.getIsDirty()}getValueOrNull(n){var t=this.formContext.getAttribute(n);return t?t.getValue():null}getLookupValue(n){var i=this.formContext.getAttribute(n),t;return i?(t=i.getValue(),t&&t[0]&&t[0].id?{entityType:t[0].entityType,id:this.cleanupGuid(t[0].id),name:t[0].name}:null):null}getIdFromLookup(n){var i=this.formContext.getAttribute(n),t;return i?(t=i.getValue(),t&&t[0]&&t[0].id?this.cleanupGuid(t[0].id):null):null}setIdInLookup(n,t,i,r,u=false){var e,o,f=[];f[0]={};f[0].id=this.cleanupGuid(r);f[0].name=i;f[0].entityType=t;(e=this.formContext.getAttribute(n))===null||e===void 0?void 0:e.setValue(f);u&&((o=this.formContext.getAttribute(n))===null||o===void 0?void 0:o.fireOnChange())}setValue(n,t,i=false){var r,u;(r=this.formContext.getAttribute(n))===null||r===void 0?void 0:r.setValue(t);i&&((u=this.formContext.getAttribute(n))===null||u===void 0?void 0:u.fireOnChange())}isCreateForm(){return this.formContext.ui.getFormType()===1}isUpdateForm(){return this.formContext.ui.getFormType()===2}openFormByName(n){this.formContext.data.entity.getIsDirty()?this.formContext.data.save().then(()=>{this.openFormByNameActual(n)},()=>{}):this.openFormByNameActual(n)}openFormByNameActual(n){for(let t of this.formContext.ui.formSelector.items.get())if(t.getLabel()==n){t.navigate();return}}getCurrentRecordId(){return this.cleanupGuid(this.formContext.data.entity.getId())}cleanupGuid(n){return n?n.toLowerCase().replace("{","").replace("}",""):""}}n.FormHelper=t})(t=n.Libs||(n.Libs={}))}(XRM||(XRM={})),function(n){var t;(function(n){class t{static getUrlParameter(n,t=location.search){t.startsWith("?")||(t=`?${t}`);n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var r=new RegExp("[\\?&]"+n+"=([^&#]*)"),i=r.exec(t);return i===null?"":decodeURIComponent(i[1].replace(/\+/g," "))}static getUrlParameterFromData(n){let i=window.location.search.substring(1),r=decodeURIComponent(i.replace("data=",""));return t.getUrlParameter(n,r)}static cleanupAttributeForApiRequest(n){return n?(n=n.split("'").join("''"),n=encodeURIComponent(n),n.split("%20").join(" ")):n}static replaceSpecialSymbol(n){return n.split("&").join("%26")}}n.UrlHelper=t})(t=n.Libs||(n.Libs={}))}(XRM||(XRM={})),function(n){var t;(function(n){function r(n){t=n.getFormContext();i=new XRM.Libs.FormHelper(t);u()}function u(){var n;(n=t.getAttribute("name"))===null||n===void 0?void 0:n.addOnChange(f);t.data.entity.addOnSave(e)}function f(){var n;const i=(n=t.getAttribute("name"))===null||n===void 0?void 0:n.getValue();alert(`Name changed to ${i}`)}function e(){}let t,i;n.onLoad=r})(t=n.Account||(n.Account={}))}(KAS||(KAS={}));